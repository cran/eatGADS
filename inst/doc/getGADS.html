<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Benjamin Becker" />

<meta name="date" content="2023-08-25" />

<title>getGADS: Using a relational eatGADS data base</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore"><code>getGADS</code>: Using a relational
eatGADS data base</h1>
<h4 class="author">Benjamin Becker</h4>
<h4 class="date">2023-08-25</h4>



<p>This vignette illustrates how a relational <code>eatGADS</code> data
base can be accessed and used. Therefore, the vignette is targeted at
users who make use of an existing data base.</p>
<p>For illustrative purposes we use a small example data base based on
the campus files of the German PISA Plus assessment. The complete campus
files and the original data set can be accessed <a href="https://www.iqb.hu-berlin.de/fdz/Datenzugang/CF-Antrag/AntragsformularCF">here</a>
and <a href="https://www.iqb.hu-berlin.de/fdz/Datenzugang/SUF-Antrag">here</a>.
The data base is installed alongside <code>eatGADS</code> and the path
can be accessed via the <code>system.file()</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(eatGADS)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>db_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pisa.db&quot;</span>, <span class="at">package =</span> <span class="st">&quot;eatGADS&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>db_path</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;C:/Users/beckerbz/AppData/Local/Temp/RtmpWwxvhW/Rinst44a833da3575/eatGADS/extdata/pisa.db&quot;</span></span></code></pre></div>
<div id="why" class="section level2">
<h2>Why?</h2>
<p>Relational data bases created by <code>eatGADS</code> provide an
alternative way of storing hierarchically structured data (e.g. from
educational large-scale assessments). Compared to conventional
approaches (one big or multiple <code>.sav</code>/<code>.Rdata</code>
files) this yields the following advantages:</p>
<ul>
<li>the data set is often smaller on disk (especially compared to
<code>.sav</code> files)</li>
<li>meta data can be accessed without loading the actual data</li>
<li>no need for reshaping, as the different hierarchy levels can be
accessed independently</li>
<li>saving working memory: often R struggles with large data sets; with
<code>eatGADS</code> we can choose which variables to load into
<code>R</code></li>
<li>flexible application of value labels and missing codes for analyses
in <code>R</code></li>
</ul>
</div>
<div id="inspecting-the-data-base" class="section level2">
<h2>Inspecting the data base</h2>
<p>We can inspect the data base structure with the
<code>namesGADS()</code> function. The function returns a named
<code>list</code>. Every list element represents a hierarchy level. The
corresponding character vector contains all variable names on this
hierarchy level.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>nam <span class="ot">&lt;-</span> <span class="fu">namesGADS</span>(db_path)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>nam</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; $noImp</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;   [1] &quot;idstud&quot;       &quot;idschool&quot;     &quot;idclass&quot;      &quot;schtype&quot;      &quot;sameteach&quot;    &quot;g8g9&quot;        </span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;   [7] &quot;ganztag&quot;      &quot;classsize&quot;    &quot;repeated&quot;     &quot;gender&quot;       &quot;age&quot;          &quot;language&quot;    </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;  [13] &quot;migration&quot;    &quot;hisced&quot;       &quot;hisei&quot;        &quot;homepos&quot;      &quot;books&quot;        &quot;pared&quot;       </span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt;  [19] &quot;computer_age&quot; &quot;internet_age&quot; &quot;int_use_a&quot;    &quot;int_use_b&quot;    &quot;truancy_a&quot;    &quot;truancy_b&quot;   </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;  [25] &quot;truancy_c&quot;    &quot;int_a&quot;        &quot;int_b&quot;        &quot;int_c&quot;        &quot;int_d&quot;        &quot;instmot_a&quot;   </span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;  [31] &quot;instmot_b&quot;    &quot;instmot_c&quot;    &quot;instmot_d&quot;    &quot;norms_a&quot;      &quot;norms_b&quot;      &quot;norms_c&quot;     </span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;  [37] &quot;norms_d&quot;      &quot;norms_e&quot;      &quot;norms_f&quot;      &quot;anxiety_a&quot;    &quot;anxiety_b&quot;    &quot;anxiety_c&quot;   </span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt;  [43] &quot;anxiety_d&quot;    &quot;anxiety_e&quot;    &quot;selfcon_a&quot;    &quot;selfcon_b&quot;    &quot;selfcon_c&quot;    &quot;selfcon_d&quot;   </span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;  [49] &quot;selfcon_e&quot;    &quot;worketh_a&quot;    &quot;worketh_b&quot;    &quot;worketh_c&quot;    &quot;worketh_d&quot;    &quot;worketh_e&quot;   </span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt;  [55] &quot;worketh_f&quot;    &quot;worketh_g&quot;    &quot;worketh_h&quot;    &quot;worketh_i&quot;    &quot;intent_a&quot;     &quot;intent_b&quot;    </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt;  [61] &quot;intent_c&quot;     &quot;intent_d&quot;     &quot;intent_e&quot;     &quot;behav_a&quot;      &quot;behav_b&quot;      &quot;behav_c&quot;     </span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt;  [67] &quot;behav_d&quot;      &quot;behav_e&quot;      &quot;behav_f&quot;      &quot;behav_g&quot;      &quot;behav_h&quot;      &quot;teach_a&quot;     </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;  [73] &quot;teach_b&quot;      &quot;teach_c&quot;      &quot;teach_d&quot;      &quot;teach_e&quot;      &quot;cognact_a&quot;    &quot;cognact_b&quot;   </span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;  [79] &quot;cognact_c&quot;    &quot;cognact_d&quot;    &quot;cognact_e&quot;    &quot;cognact_f&quot;    &quot;cognact_g&quot;    &quot;cognact_h&quot;   </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;  [85] &quot;cognact_i&quot;    &quot;discpline_a&quot;  &quot;discpline_b&quot;  &quot;discpline_c&quot;  &quot;discpline_d&quot;  &quot;discpline_e&quot; </span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;  [91] &quot;relation_a&quot;   &quot;relation_b&quot;   &quot;relation_c&quot;   &quot;relation_d&quot;   &quot;relation_e&quot;   &quot;belong_a&quot;    </span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;  [97] &quot;belong_b&quot;     &quot;belong_c&quot;     &quot;belong_d&quot;     &quot;belong_e&quot;     &quot;belong_f&quot;     &quot;belong_g&quot;    </span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; [103] &quot;belong_h&quot;     &quot;belong_i&quot;     &quot;attitud_a&quot;    &quot;attitud_b&quot;    &quot;attitud_c&quot;    &quot;attitud_d&quot;   </span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; [109] &quot;attitud_e&quot;    &quot;attitud_f&quot;    &quot;attitud_g&quot;    &quot;attitud_h&quot;    &quot;grade_de&quot;     &quot;grade_ma&quot;    </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt; [115] &quot;grade_bio&quot;    &quot;grade_che&quot;    &quot;grade_phy&quot;    &quot;grade_sci&quot;   </span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; $PVs</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; [1] &quot;idstud&quot;    &quot;dimension&quot; &quot;imp&quot;       &quot;value&quot;</span></span></code></pre></div>
<p>The example data base contains two hierarchy levels: A student level
(<code>noImp</code>) and a plausible value level (<code>PVs</code>). On
the student level, each row represents an individual student. On the
plausible value level, each row represents an imputation number of a
specific domain of an individual student.</p>
<p>We can access meta information of the variables in the data set using
the <code>extractMeta()</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Meta data for one variable</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">extractMeta</span>(db_path, <span class="st">&quot;age&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;   varName             varLabel format display_width labeled value valLabel missings data_table</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; 1     age Age of student at T1   F8.2            NA      no    NA     &lt;NA&gt;     &lt;NA&gt;      noImp</span></span></code></pre></div>
<p>To supply variables names we can also use the named list
<code>nam</code> extracted earlier. This way, we can extract all meta
information available for a hierarchy level.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">extractMeta</span>(db_path, nam<span class="sc">$</span>PVs)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;       varName                                       varLabel format display_width labeled value</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; 236    idstud                                     Student-ID   F8.0            NA      no    NA</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 451    idstud                                     Student-ID   F8.0            NA      no    NA</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 452 dimension Achievement dimension (math, reading, science)   &lt;NA&gt;            NA     yes     1</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 453 dimension Achievement dimension (math, reading, science)   &lt;NA&gt;            NA     yes     2</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 454 dimension Achievement dimension (math, reading, science)   &lt;NA&gt;            NA     yes     3</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 455       imp       Number of imputation of plausible values   &lt;NA&gt;            NA      no    NA</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 456     value                                Plausible Value   &lt;NA&gt;            NA      no    NA</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;     valLabel missings data_table</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; 236     &lt;NA&gt;     &lt;NA&gt;      noImp</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; 451     &lt;NA&gt;     &lt;NA&gt;        PVs</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 452       ma    valid        PVs</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; 453      rea    valid        PVs</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; 454      sci    valid        PVs</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; 455     &lt;NA&gt;     &lt;NA&gt;        PVs</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; 456     &lt;NA&gt;     &lt;NA&gt;        PVs</span></span></code></pre></div>
<p>Commonly the most informative columns are <code>varLabel</code>
(containing variable labels), <code>value</code> (referencing labeled
values), <code>valLabel</code> (containing value labels) and
<code>missings</code> (is a labeled value a missing value
(<code>&quot;miss&quot;</code>) or not (<code>&quot;valid&quot;</code>)).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Meta data for manually chosen multiple variables</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">extractMeta</span>(db_path, <span class="fu">c</span>(<span class="st">&quot;idstud&quot;</span>, <span class="st">&quot;schtype&quot;</span>))</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;     varName     varLabel format display_width labeled value</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 236  idstud   Student-ID   F8.0            NA      no    NA</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 360 schtype School track   F8.0            NA     yes     1</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 361 schtype School track   F8.0            NA     yes     2</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 362 schtype School track   F8.0            NA     yes     3</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 451  idstud   Student-ID   F8.0            NA      no    NA</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;                                      valLabel missings data_table</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; 236                                      &lt;NA&gt;     &lt;NA&gt;      noImp</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; 360                Gymnasium (academic track)    valid      noImp</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; 361                                Realschule    valid      noImp</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; 362 schools with several courses of education    valid      noImp</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; 451                                      &lt;NA&gt;     &lt;NA&gt;        PVs</span></span></code></pre></div>
</div>
<div id="extract-data-from-data-base" class="section level2">
<h2>Extract data from data base</h2>
<p>To extract a data set from the data base, we can use the function
<code>getGADS()</code>. If the data base is stored on a server drive,
<code>getGADS_fast()</code> provides identical functionality but
substantially increases the performance. With the <code>vSelect</code>
argument we specify our variable selection. It is important to note that
<code>getGADS()</code> returns a so called <code>GADSdat</code> object.
This object type contains complex meta information (that is for example
also available in a <code>SPSS</code> data set), and is therefore not
directly usable for data analysis. We can, however, use the
<code>extractMeta()</code> function on it to access the meta data.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>gads1 <span class="ot">&lt;-</span> <span class="fu">getGADS</span>(<span class="at">filePath =</span> db_path, <span class="at">vSelect =</span> <span class="fu">c</span>(<span class="st">&quot;idstud&quot;</span>, <span class="st">&quot;schtype&quot;</span>, <span class="st">&quot;gender&quot;</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">class</span>(gads1)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;GADSdat&quot; &quot;list&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">extractMeta</span>(gads1)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;     varName     varLabel format display_width labeled value</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; 194  gender       Gender   F8.0            NA     yes     1</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; 195  gender       Gender   F8.0            NA     yes     2</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; 236  idstud   Student-ID   F8.0            NA      no    NA</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; 360 schtype School track   F8.0            NA     yes     1</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; 361 schtype School track   F8.0            NA     yes     2</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; 362 schtype School track   F8.0            NA     yes     3</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt;                                      valLabel missings</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; 194                                    Female    valid</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; 195                                      Male    valid</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; 236                                      &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; 360                Gymnasium (academic track)    valid</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; 361                                Realschule    valid</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; 362 schools with several courses of education    valid</span></span></code></pre></div>
</div>
<div id="extract-data-from-gadsdat" class="section level2">
<h2>Extract data from <code>GADSdat</code></h2>
<p>If we want to use the data for analyses in <code>R</code> we have to
extract it from the <code>GADSdat</code> object via the function
<code>extractData2()</code>. In doing so, we have to make two important
decisions: (a) how should values marked as missing values be treated
(<code>convertMiss</code>)? And (b) how should labeled values in general
be treated (<code>labels2character</code>, <code>labels2factor</code>,
<code>labels2ordered</code>, and <code>dropPartialLabels</code>)?</p>
<p>Per default, all missing tags are applied, meaning all values tagged
as missing are recoded to <code>NA</code>
(<code>convertMiss == TRUE</code>). Furthermore, per default, all value
labels are dropped (<code>labels2character = NULL</code>,
<code>labels2factor = NULL</code>, <code>labels2ordered = NULL</code>).
If for specific variables, value labels should be applied and the
resulting variable should be a character variable, this can specified
via, for example, setting
<code>labels2character = c(&quot;var1&quot;, &quot;var2&quot;)</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">## leave all labeled variables as numeric, convert missings to NA</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> <span class="fu">extractData2</span>(gads1)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">head</span>(dat1)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;   idstud schtype gender</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 1      1       2      1</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 2      2       3      1</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 3      3       1      2</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 4      4       3      2</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 5      5       2      1</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; 6      6       3      1</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="do">## convert selected labeled variable(s) to character, convert missings to NA</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">extractData2</span>(gads1, <span class="at">labels2character =</span> <span class="fu">c</span>(<span class="st">&quot;schtype&quot;</span>))</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="fu">head</span>(dat2)</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt;   idstud                                   schtype gender</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; 1      1                                Realschule      1</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; 2      2 schools with several courses of education      1</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; 3      3                Gymnasium (academic track)      2</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; 4      4 schools with several courses of education      2</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; 5      5                                Realschule      1</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; 6      6 schools with several courses of education      1</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="do">## convert all labeled variables to character, convert missings to NA</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> <span class="fu">extractData2</span>(gads1, <span class="at">labels2character =</span> <span class="fu">namesGADS</span>(gads1))</span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="fu">head</span>(dat3)</span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt;   idstud                                   schtype gender</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; 1      1                                Realschule Female</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt; 2      2 schools with several courses of education Female</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt; 3      3                Gymnasium (academic track)   Male</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt; 4      4 schools with several courses of education   Male</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt; 5      5                                Realschule Female</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt; 6      6 schools with several courses of education Female</span></span></code></pre></div>
<p>In general, we recommend leaving labeled variables as numeric and
converting values with missing codes to <code>NA</code>. If required,
values labels can always be accessed via using
<code>extractMeta()</code> on the <code>GADSdat</code> object or the
data base.</p>
</div>
<div id="selecting-different-hierarchy-levels" class="section level2">
<h2>Selecting different hierarchy levels</h2>
<p>An important feature of <code>eatGADS</code> relational data bases
are that data sets are automatically returned on the correct hierarchy
level. For an overview of different data structures, see <a href="https://doi.org/10.18637/jss.v059.i10">“Tidy Data”</a> or <a href="https://www.theanalysisfactor.com/wide-and-long-data/">this
article explaining long and wide format using repeated measures</a>. In
educational large-scale assessments, data usually contain multiple
imputations or plausible values. Packages that enable us analyzing these
types of data (like <a href="https://github.com/weirichs/eatRep"><code>eatRep</code></a>) often
require these data in the long format.</p>
<p>The function <code>getGADS()</code> extracts data automatically in
the appropriate structure, depending on our variable selection. If we
select only variables from the student level, the data returned is on
the student level. Each student is represented in a single row.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>gads1 <span class="ot">&lt;-</span> <span class="fu">getGADS</span>(db_path, <span class="at">vSelect =</span> <span class="fu">c</span>(<span class="st">&quot;schtype&quot;</span>, <span class="st">&quot;g8g9&quot;</span>))</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> <span class="fu">extractData2</span>(gads1)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">dim</span>(dat1)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; [1] 500   3</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">head</span>(dat1)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;   idstud schtype g8g9</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 1      1       2   NA</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 2      2       3   NA</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; 3      3       1    1</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; 4      4       3   NA</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; 5      5       2   NA</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; 6      6       3   NA</span></span></code></pre></div>
<p>If additionally variables from the plausible Value data table are
extracted, the returned data structure changes. In the <code>PVs</code>
data table, data is stored on the “student x dimension x plausible value
number” level. The returned data has exactly this structure.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>gads2 <span class="ot">&lt;-</span> <span class="fu">getGADS</span>(db_path, <span class="at">vSelect =</span> <span class="fu">c</span>(<span class="st">&quot;schtype&quot;</span>, <span class="st">&quot;value&quot;</span>))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">extractData2</span>(gads2)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">dim</span>(dat2)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; [1] 7500    5</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">head</span>(dat2)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;   idstud schtype dimension imp       value</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; 1      1       2         1   1  0.15372011</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; 2      1       2         2   1  0.43914365</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; 3      1       2         3   1  0.13177617</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; 4      1       2         1   2 -0.04119330</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; 5      1       2         2   2  0.01991714</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; 6      1       2         3   2  0.67830064</span></span></code></pre></div>
<p>These two examples highlight another feature of
<code>getGADS()</code>: Only variables of substantial interest have to
be selected for extraction. The correct ID variables are added
automatically.</p>
</div>
<div id="trend-data-bases" class="section level2">
<h2>Trend data bases</h2>
<p>In educational large-scale assessments, a common challenge is
reporting longitudinal developments (<em>trends</em>).
<code>getTrendGADS</code> allows extracting data from multiple data
bases with identical variables in it.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>trend_path1 <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;trend_gads_2020.db&quot;</span>, <span class="at">package =</span> <span class="st">&quot;eatGADS&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>trend_path2 <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;trend_gads_2015.db&quot;</span>, <span class="at">package =</span> <span class="st">&quot;eatGADS&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>trend_path3 <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;trend_gads_2010.db&quot;</span>, <span class="at">package =</span> <span class="st">&quot;eatGADS&quot;</span>)</span></code></pre></div>
<p><code>eatGADS</code> comes with three small trend data bases which
can be used for illustrative purposes.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>gads_trend <span class="ot">&lt;-</span> <span class="fu">getTrendGADS</span>(<span class="at">filePaths =</span> <span class="fu">c</span>(trend_path1, trend_path2, trend_path3), </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>                           <span class="at">vSelect =</span> <span class="fu">c</span>(<span class="st">&quot;idstud&quot;</span>, <span class="st">&quot;dimension&quot;</span>, <span class="st">&quot;score&quot;</span>), </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                           <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">2015</span>, <span class="dv">2010</span>), <span class="at">fast =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt;  -----  Loading GADS 2020 ----- </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt;  -----  Loading GADS 2015 ----- </span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt;  -----  Loading GADS 2010 -----</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>dat_trend <span class="ot">&lt;-</span> <span class="fu">extractData2</span>(gads_trend)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="fu">head</span>(dat_trend)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;   idstud dimension imp    score year</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; 1     61         1   2 434.1060 2020</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; 2     61         2   2 434.1060 2020</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; 3     62         1   1 426.8199 2020</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; 4     62         2   1 426.8199 2020</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; 5     63         1   2 427.7327 2020</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; 6     63         2   2 427.7327 2020</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
